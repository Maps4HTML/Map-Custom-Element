<!DOCTYPE html>
<html lang="en">

<head>
  <title>MapML 2 geoJSON</title>
  <meta charset="UTF-8">
  <script type="module" src="mapml-viewer.js"></script>
  <!--Expected output geoJSON are stored here-->
  <script src="mapml2geojsonJSON.js"></script>
</head>

<body>
  <!--All the mapml layers- that will be converted to geojson go in the mapml-viewer-->
    <mapml-viewer projection="OSMTILE" zoom="10" lon="-75.7" lat="45.4" controls>
        
      <layer- label="Point Geometry" checked>
          <map-feature>
            <map-featurecaption>Point</map-featurecaption>
            <map-geometry>
              <map-point class="point">
                <map-coordinates>-75.6916809 45.4186964</map-coordinates>
              </map-point>
            </map-geometry>
            <map-properties><h2>This is a Point</h2></map-properties>
          </map-feature>
        </layer->

        <layer- label="Line Geometry" checked>
          <map-feature>
            <map-featurecaption>Line</map-featurecaption>
            <map-geometry>
              <map-linestring class="line">
                <map-coordinates>-75.6168365 45.471929 -75.6855011 45.458445 -75.7016373 45.4391764 -75.7030106 45.4259255 -75.7236099 45.4208652 -75.7565689 45.4117074 -75.7833481 45.384225 -75.8197403 45.3714435 -75.8516693 45.377714</map-coordinates>
              </map-linestring>
            </map-geometry>
            <map-properties><h2>This is a Line</h2></map-properties>
          </map-feature>
        </layer->

        <layer- label="Polygon Geometry" checked>
          <map-feature>
            <map-featurecaption>Polygon</map-featurecaption>
            <map-geometry>
              <map-polygon class="polygon">
                <map-coordinates>-75.5859375 45.4656690 -75.6813812 45.4533876 -75.6961441 45.4239978 -75.7249832 45.4083331 -75.7792282 45.3772317 -75.7534790 45.3294614 -75.5831909 45.3815724 -75.6024170 45.4273712 -75.5673981 45.4639834 -75.5859375 45.4656690</map-coordinates>
                <map-coordinates>-75.6596588 45.4211062 -75.6338958 45.4254436 -75.6277127 45.4066458 -75.6572542 45.4097792 -75.6596588 45.4211062</map-coordinates>
              </map-polygon>
            </map-geometry>
            <map-properties><h2>This is a Polygon</h2></map-properties>
          </map-feature>
        </layer->

        <layer- label="MultiPoint Geometry" checked>
          <map-feature>
            <map-featurecaption>MultiPoint</map-featurecaption>
            <map-geometry>
              <map-multipoint class="point">
                <map-coordinates>-75.7016373 45.4391764 -75.7236099 45.4208652 -75.7833481 45.384225</map-coordinates>
              </map-multipoint>
            </map-geometry>
            <map-properties><h2>This is a multipoint</h2></map-properties>
          </map-feature>
        </layer->

        <layer- label="MultiLineString Geometry" checked>
          <map-feature>
            <map-featurecaption>MultiLineString</map-featurecaption>
            <map-geometry>
              <map-multilinestring class="line">
                <map-coordinates>-75.6168365 45.471929 -75.6855011 45.458445 -75.7016373 45.4391764 -75.7030106 45.4259255</map-coordinates>
                <map-coordinates>-75.7565689 45.4117074 -75.7833481 45.384225 -75.8197403 45.3714435 -75.8516693 45.377714</map-coordinates>
              </map-multilinestring>
            </map-geometry>
            <map-properties><h2>This is a MultiLineString</h2></map-properties>
          </map-feature>
        </layer->

        <layer- label="MultiPolygon Geometry" checked>
          <map-feature>
            <map-featurecaption>MultiPolygon</map-featurecaption>
            <map-geometry>
              <map-multipolygon class="polygon">
                <map-polygon>
                  <map-coordinates>-75.5859375 45.4656690 -75.6813812 45.4533876 -75.6961441 45.4239978 -75.7249832 45.4083331 -75.7792282 45.3772317 -75.7534790 45.3294614 -75.5831909 45.3815724 -75.6024170 45.4273712 -75.5673981 45.4639834 -75.5859375 45.4656690</map-coordinates>
                </map-polygon>
                <map-polygon>
                  <map-coordinates>-75.6744295 45.4728920 -75.7053451 45.4439942 -75.7063756 45.4249616 -75.7489704 45.4177324 -75.7788555 45.4003785 -75.7943133 45.4321899 -75.6744295 45.4728920</map-coordinates>
                </map-polygon>
              </map-multipolygon>
            </map-geometry>
            <map-properties><h2>This is a MultiPolygon</h2></map-properties>
          </map-feature>
        </layer->






        <layer- label="Test MapML" checked>
          <map-feature>
            <map-featurecaption>Polygon</map-featurecaption>
            <map-geometry>
              <map-polygon class="polygon">
                <map-coordinates>-75.5859375 45.4656690 -75.6813812 45.4533876 -75.6961441 45.4239978 -75.7249832 45.4083331 -75.7792282 45.3772317 -75.7534790 45.3294614 -75.5831909 45.3815724 -75.6024170 45.4273712 -75.5673981 45.4639834 -75.5859375 45.4656690</map-coordinates>
              </map-polygon>
            </map-geometry>
            <map-properties id="properties"><table><thead><tr><th role="columnheader" scope="col">Property name</th><th role="columnheader" scope="col">Property value</th></tr></thead><tbody><tr><th scope="row">id</th><td itemprop="id">24e21a60be4811d892e2080020a0f4c9</td></tr><tr><th scope="row">label_fr</th><td itemprop="label_fr">Québec</td></tr><tr><th scope="row">label_en</th><td itemprop="label_en">Québec</td></tr><tr><th scope="row">label_ab</th><td itemprop="label_ab">Québec</td></tr><tr><th scope="row">type_fr</th><td itemprop="type_fr">CITY-Ville</td></tr><tr><th scope="row">type_en</th><td itemprop="type_en">CITY-City</td></tr></tbody></table></map-properties>
          </map-feature>
      
          <map-feature>
            <map-featurecaption>Line</map-featurecaption>
            <map-geometry>
              <map-linestring class="line">
                <map-coordinates>-75.6168365 45.471929 -75.6855011 45.458445 -75.7016373 45.4391764 -75.7030106 45.4259255 -75.7236099 45.4208652 -75.7565689 45.4117074 -75.7833481 45.384225 -75.8197403 45.3714435 -75.8516693 45.377714</map-coordinates>
              </map-linestring>
            </map-geometry>
            <map-properties><h2>This is a Line</h2></map-properties>
          </map-feature>
      
          <map-feature>
            <map-featurecaption>Point</map-featurecaption>
            <map-geometry>
              <map-point class="point">
                <map-coordinates>-75.6916809 45.4186964</map-coordinates>
              </map-point>
            </map-geometry>
            <map-properties><h2>This is a Point</h2></map-properties>
          </map-feature>

          <map-feature>
            <map-featurecaption>MultiPoint</map-featurecaption>
            <map-geometry>
              <map-multipoint class="point">
                <map-coordinates>-75.7016373 45.4391764 -75.7236099 45.4208652 -75.7833481 45.384225</map-coordinates>
              </map-multipoint>
            </map-geometry>
            <map-properties><h2>This is a multipoint</h2></map-properties>
          </map-feature>

          <map-feature>
            <map-featurecaption>MultiLineString</map-featurecaption>
            <map-geometry>
              <map-multilinestring class="line">
                <map-coordinates>-75.6168365 45.471929 -75.6855011 45.458445 -75.7016373 45.4391764 -75.7030106 45.4259255</map-coordinates>
                <map-coordinates>-75.7565689 45.4117074 -75.7833481 45.384225 -75.8197403 45.3714435 -75.8516693 45.377714</map-coordinates>
              </map-multilinestring>
            </map-geometry>
            <map-properties><h2>This is a MultiLineString</h2></map-properties>
          </map-feature>

          <map-feature>
            <map-featurecaption>MultiPolygon</map-featurecaption>
            <map-geometry>
              <map-multipolygon class="polygon">
                <map-polygon>
                  <map-coordinates>-75.5859375 45.4656690 -75.6813812 45.4533876 -75.6961441 45.4239978 -75.7249832 45.4083331 -75.7792282 45.3772317 -75.7534790 45.3294614 -75.5831909 45.3815724 -75.6024170 45.4273712 -75.5673981 45.4639834 -75.5859375 45.4656690</map-coordinates>
                </map-polygon>
                <map-polygon>
                  <map-coordinates>-75.6744295 45.4728920 -75.7053451 45.4439942 -75.7063756 45.4249616 -75.7489704 45.4177324 -75.7788555 45.4003785 -75.7943133 45.4321899 -75.6744295 45.4728920</map-coordinates>
                  <map-coordinates>-75.6744295 45.4728920 -75.7053451 45.4439942 -75.7063756 45.4249616 -75.7489704 45.4177324 -75.7788555 45.4003785 -75.7943133 45.4321899 -75.6744295 45.4728920</map-coordinates>
                </map-polygon>
              </map-multipolygon>
            </map-geometry>
            <map-properties><h2>This is a MultiPolygon</h2></map-properties>
          </map-feature>

          <map-feature>
            <map-featurecaption>Polygon with holes</map-featurecaption>
            <map-geometry>
              <map-polygon>
                <map-coordinates>-75.5859375 45.4656690 -75.6813812 45.4533876 -75.6961441 45.4239978 -75.7249832 45.4083331 -75.7792282 45.3772317 -75.7534790 45.3294614 -75.5831909 45.3815724 -75.6024170 45.4273712 -75.5673981 45.4639834 -75.5859375 45.4656690</map-coordinates>
                <map-coordinates><map-span class="hole">-75.6467062 45.4215881 -75.6889363 45.4049585 -75.6693647 45.3767494 -75.6270640 45.3924229 -75.6467062 45.4215881</map-span></map-coordinates>
              </map-polygon>
            </map-geometry>
            <map-properties><h2>This is a Polygon with holes</h2></map-properties>
          </map-feature>
        </layer->

        <layer- label="Geometry Collection" checked>
           <map-feature>
              <map-featurecaption></map-featurecaption>
              <map-geometry>
                 <map-geometrycollection>
                    <map-polygon>
                       <map-coordinates>-75.5859375 45.465669 -75.6813812 45.4533876 -75.6961441 45.4239978 -75.7249832 45.4083331 -75.7792282 45.3772317 -75.753479 45.3294614 -75.5831909 45.3815724 -75.602417 45.4273712 -75.5673981 45.4639834 -75.5859375 45.465669 </map-coordinates>
                    </map-polygon>
                    <map-linestring>
                       <map-coordinates>-75.6168365 45.471929 -75.6855011 45.458445 -75.7016373 45.4391764 -75.7030106 45.4259255 -75.7236099 45.4208652 -75.7565689 45.4117074 -75.7833481 45.384225 -75.8197403 45.3714435 -75.8516693 45.377714 </map-coordinates>
                    </map-linestring>
                    <map-point>
                       <map-coordinates>-75.6916809 45.4186964</map-coordinates>
                    </map-point>
                 </map-geometrycollection>
              </map-geometry>
              <map-properties>
                <table>
                  <thead>
                    <tr>
                      <th role="columnheader" scope="col">Property name</th>
                      <th role="columnheader" scope="col">Property value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th scope="row">prop0</th>
                      <td itemprop="prop0">This is a Geometry Collection</td>
                    </tr>
                  </tbody>
                </table>
              </map-properties>
           </map-feature>
        </layer->

        <layer- label="Point Geometry" checked>
          <map-meta name="extent" content="top-left-longitude=-75.916809, top-left-latitude=45.886964, bottom-right-longitude=-75.516809,bottom-right-latitude=45.26964"></map-meta>
          <map-feature>
            <map-featurecaption>Point</map-featurecaption>
            <map-geometry>
              <map-point class="point">
                <map-coordinates>-75.6916809 45.4186964</map-coordinates>
              </map-point>
            </map-geometry>
            <map-properties>
              <h2>This is <div>bolded and emphasized</div>.</h2>
            </map-properties>
          </map-feature>
        </layer->

        <layer- label="Point Geometry" checked>
          <map-meta name="extent" content="top-left-longitude=-75.916809, top-left-latitude=45.886964, bottom-right-longitude=-75.516809,bottom-right-latitude=45.26964"></map-meta>
          <map-feature>
            <map-featurecaption>Point</map-featurecaption>
            <map-geometry>
              <map-point class="point">
                <map-coordinates>-75.6916809 45.4186964</map-coordinates>
              </map-point>
            </map-geometry>
            <map-properties>
              <table>
                <thead>
                  <tr>
                    <th role="columnheader" scope="col">Property name</th>
                    <th role="columnheader" scope="col">Property value</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">prop0</th>
                    <td itemprop="prop0">This is a Point</td>
                  </tr>
                </tbody>
              </table>
            </map-properties>
          </map-feature>
        </layer->

        <layer- label="map-a geometry" checked>
            <map-meta name="zoom" content="min=1,max=5,value=0"></map-meta>
          <map-feature zoom="2" class="refDiff">
            <map-properties><h1>Test</h1></map-properties>
            <map-geometry cs="tilematrix">
              <map-a href="https://geogratis.gc.ca/mapml/en/cbmtile/cbmtgeom/" target="_self" type="text/html">
                <map-geometrycollection>
                  <map-polygon>
                    <map-coordinates>9 10 10 10 10 11 9 11 9 10</map-coordinates>
                  </map-polygon>
                  <map-a href="https://geogratis.gc.ca/mapml/en/cbmtile/fdi/" target="_top" type="text/html">
                    <map-point>
                      <map-coordinates>10.5 11</map-coordinates>
                    </map-point>
                  </map-a>
                </map-geometrycollection>
              </map-a>
            </map-geometry>
          </map-feature>
          <map-feature>
            <map-featurecaption>Geometry Collection</map-featurecaption>
            <map-geometry>
              <map-geometrycollection>
                <map-polygon class="polygon">
                  <map-coordinates>-75.5859375 45.4656690 -75.6813812 45.4533876 -75.6961441 45.4239978 -75.7249832 45.4083331
                    -75.7792282 45.3772317 -75.7534790 45.3294614 -75.5831909 45.3815724 -75.6024170 45.4273712 -75.5673981
                    45.4639834 -75.5859375 45.4656690</map-coordinates>
                </map-polygon>
                <map-a>
                  <map-span>
                    <map-linestring class="line">
                      <map-coordinates>-75.6168365 45.471929 -75.6855011 45.458445 -75.7016373 45.4391764 -75.7030106 45.4259255
                        -75.7236099 45.4208652 -75.7565689 45.4117074 -75.7833481 45.384225 -75.8197403 45.3714435 -75.8516693
                        45.377714</map-coordinates>
                    </map-linestring>
                    <map-a>
                      <map-point class="point">
                        <map-coordinates>-75.6916809 45.4186964</map-coordinates>
                      </map-point>
                    </map-a>
                  </map-span>
                </map-a>
              </map-geometrycollection>
            </map-geometry>
            <map-properties><h2>This is a Geometry Collection</h2></map-properties>
          </map-feature>
        </layer->

      </mapml-viewer>

      <!--mapml2geojson json output goes here dynamically-->
      <p id="json0"></p>
      <p id="json1"></p>
      <p id="json2"></p>
      <p id="json3"></p>
      <p id="json4"></p>
      <p id="json5"></p>
      <p id="json6"></p>
      <p id="json7"></p>
      <p id="json8"></p>
      <p id="json9"></p>
      <p id="json10"></p>

      <hr>

      <!--mapml2geojson expected json-->
      <p id="exp0"></p>
      <p id="exp1"></p>
      <p id="exp2"></p>
      <p id="exp3"></p>
      <p id="exp4"></p>
      <p id="exp5"></p>
      <p id="exp6"></p>
      <p id="exp7"></p>
      <p id="exp8"></p>
      <p id="exp9"></p>
      <p id="exp10"></p>

      <script>
        window.onload = function() {
            // Putting expected output at their relevant spots
            point = JSON.stringify(point);
            document.getElementById('exp0').innerHTML = point;
            line = JSON.stringify(line);
            document.getElementById('exp1').innerHTML = line;
            polygon = JSON.stringify(polygon);
            document.getElementById('exp2').innerHTML = polygon;
            multipoint = JSON.stringify(multipoint);
            document.getElementById('exp3').innerHTML = multipoint;
            multilinestring = JSON.stringify(multilinestring);
            document.getElementById('exp4').innerHTML = multilinestring;
            multipolygon = JSON.stringify(multipolygon);
            document.getElementById('exp5').innerHTML = multipolygon;
            featurecollection = JSON.stringify(featurecollection);
            document.getElementById('exp6').innerHTML = featurecollection;
            geometrycollection = JSON.stringify(geometrycollection);
            document.getElementById('exp7').innerHTML = geometrycollection;
            propertyFunction = JSON.stringify(propertyFunction);
            document.getElementById('exp8').innerHTML = propertyFunction;
            transform = JSON.stringify(transform);
            document.getElementById('exp9').innerHTML = transform;
            mapAGeometryCollection = JSON.stringify(mapAGeometryCollection);
            document.getElementById('exp10').innerHTML = mapAGeometryCollection;

            let json;

            json = document.querySelectorAll("layer-")[0].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json0').innerHTML = json;

            json = document.querySelectorAll("layer-")[1].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json1').innerHTML = json;

            json = document.querySelectorAll("layer-")[2].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json2').innerHTML = json;
            
            json = document.querySelectorAll("layer-")[3].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json3').innerHTML = json;

            json = document.querySelectorAll("layer-")[4].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json4').innerHTML = json;

            json = document.querySelectorAll("layer-")[5].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json5').innerHTML = json;

            json = document.querySelectorAll("layer-")[6].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json6').innerHTML = json;

            json = document.querySelectorAll("layer-")[7].mapml2geojson();
            json = JSON.stringify(json);
            document.getElementById('json7').innerHTML = json;

            // propertyFunction
            let propF = function f(p) {
              let prop = {};
              prop["name"] = p.querySelector("div").innerHTML;
              return prop;
            }
            json = document.querySelectorAll("layer-")[8].mapml2geojson({propertyFunction: propF});
            json = JSON.stringify(json);
            document.getElementById('json8').innerHTML = json;

            json = document.querySelectorAll("layer-")[9].mapml2geojson({transform: false});
            json = JSON.stringify(json);
            document.getElementById('json9').innerHTML = json;

            json = document.querySelectorAll("layer-")[10].mapml2geojson({transform: false});
            json = JSON.stringify(json);
            document.getElementById('json10').innerHTML = json;
        };
      </script>
    
</body>

</html>
